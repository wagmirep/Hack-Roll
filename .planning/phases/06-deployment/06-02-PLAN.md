---
phase: 06-deployment
plan: 02
type: execute
---

<objective>
Deploy Expo web frontend to Vercel and configure for production.

Purpose: Provide web-accessible demo for judges to scan QR code and use the app.
Output:
- Expo web build deployed to Vercel
- Mobile app pointing to production backend
- QR code for demo
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/06-deployment/06-01-SUMMARY.md
@mobile/package.json
@mobile/app.json
@mobile/src/api/client.ts

**Prerequisite:** Backend deployed to Railway (from Plan 06-01)

**Frontend architecture:**
- Expo 50 with react-native-web
- Uses EXPO_PUBLIC_API_URL for backend URL
- Supabase client for auth (already cloud)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure Expo for web deployment</name>
  <files>mobile/app.json, mobile/.env.production</files>
  <action>
1. Update app.json web config if needed:
   - Ensure "web" section has proper bundler config
   - Add: "bundler": "metro" under web if missing

2. Create .env.production with:
   ```
   EXPO_PUBLIC_API_URL=https://YOUR-RAILWAY-URL
   EXPO_PUBLIC_SUPABASE_URL=<from existing .env>
   EXPO_PUBLIC_SUPABASE_ANON_KEY=<from existing .env>
   ```

3. Update mobile/src/api/client.ts to ensure it reads from EXPO_PUBLIC_API_URL correctly (verify it does).
  </action>
  <verify>Check that client.ts uses process.env.EXPO_PUBLIC_API_URL</verify>
  <done>Expo configured for production with correct API URL</done>
</task>

<task type="auto">
  <name>Task 2: Build and deploy Expo web to Vercel</name>
  <files>mobile/vercel.json</files>
  <action>
Option A - Expo export + Vercel deploy:
1. cd mobile
2. Create vercel.json:
   ```json
   {
     "buildCommand": "npx expo export --platform web",
     "outputDirectory": "dist",
     "framework": null
   }
   ```
3. Deploy: `vercel --prod`
4. Set env vars in Vercel dashboard or CLI:
   - EXPO_PUBLIC_API_URL=https://railway-url
   - EXPO_PUBLIC_SUPABASE_URL
   - EXPO_PUBLIC_SUPABASE_ANON_KEY

Option B - If Option A has issues, use Vercel's Expo preset:
1. `vercel link` in mobile/
2. Vercel auto-detects Expo
3. Deploy with `vercel --prod`

Get the production URL from Vercel output.
  </action>
  <verify>Visit Vercel URL, app loads without errors</verify>
  <done>Expo web app deployed to Vercel with production URL</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Full LahStats web app deployed</what-built>
  <how-to-verify>
    1. Visit: https://YOUR-VERCEL-URL
    2. Confirm: App loads (login/signup screen appears)
    3. Test login: Create account or login
    4. Test recording: Start a short test recording
    5. Verify: Recording uploads to backend (check network tab or Railway logs)
    6. Test full flow: End recording → processing → claiming → results
  </how-to-verify>
  <resume-signal>Confirm full flow works, or describe which step fails</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Expo web build succeeds
- [ ] Vercel deployment live
- [ ] App loads at Vercel URL
- [ ] Can login/signup
- [ ] Recording flow connects to Railway backend
</verification>

<success_criteria>
- Expo web deployed to Vercel
- Frontend connects to Railway backend
- Full demo flow works end-to-end
- Ready for QR code generation
</success_criteria>

<output>
After completion, create `.planning/phases/06-deployment/06-02-SUMMARY.md`:

# Phase 6 Plan 02: Frontend Deployment Summary

**[Deployed Expo web to Vercel at URL]**

## Accomplishments
- Configured Expo for production
- Deployed to Vercel
- Full demo flow verified

## Files Created/Modified
- `mobile/vercel.json` - Vercel build config
- `mobile/.env.production` - Production env vars

## Decisions Made
[Any decisions]

## Issues Encountered
[Problems and resolutions, or "None"]

## Next Step
Ready for 06-03-PLAN.md (QR code and final polish)
</output>
